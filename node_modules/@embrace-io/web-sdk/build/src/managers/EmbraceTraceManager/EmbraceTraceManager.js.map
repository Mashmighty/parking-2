{"version":3,"file":"EmbraceTraceManager.js","sources":["../../../../src/managers/EmbraceTraceManager/EmbraceTraceManager.ts"],"sourcesContent":["import type { Context } from '@opentelemetry/api';\nimport { context, trace } from '@opentelemetry/api';\nimport type {\n  ExtendedSpan,\n  ExtendedSpanOptions,\n  TraceManager,\n} from '../../api-traces/index.js';\nimport { EMB_TYPES, KEY_EMB_TYPE } from '../../constants/index.js';\nimport { EmbraceExtendedSpan } from './EmbraceExtendedSpan.js';\n\nexport class EmbraceTraceManager implements TraceManager {\n  public startSpan(\n    name: string,\n    options: ExtendedSpanOptions = {},\n    ctx?: Context\n  ): ExtendedSpan {\n    const tracer = trace.getTracer('embrace-web-sdk-traces');\n\n    options.attributes = options.attributes ? options.attributes : {};\n    options.attributes[KEY_EMB_TYPE] = EMB_TYPES.Perf;\n\n    const activeContext = options.parentSpan\n      ? trace.setSpan(context.active(), options.parentSpan)\n      : ctx;\n\n    return new EmbraceExtendedSpan(\n      tracer.startSpan(name, options, activeContext)\n    );\n  }\n\n  public setSpan: TraceManager['setSpan'] = trace.setSpan;\n\n  public getSpan(context: Context): ExtendedSpan | undefined {\n    const span = trace.getSpan(context);\n\n    if (span) {\n      return new EmbraceExtendedSpan(span);\n    }\n\n    return undefined;\n  }\n}\n"],"names":["EmbraceTraceManager","startSpan","name","options","ctx","tracer","trace","getTracer","attributes","KEY_EMB_TYPE","EMB_TYPES","Perf","activeContext","parentSpan","setSpan","context","active","EmbraceExtendedSpan","getSpan","span","undefined"],"mappings":";;;;;;AAUO,MAAMA,mBAAAA,CAAAA;AACJC,IAAAA,SAAAA,CACLC,IAAY,EACZC,OAAAA,GAA+B,EAAE,EACjCC,GAAa,EACC;QACd,MAAMC,MAAAA,GAASC,SAAAA,CAAMC,SAAS,CAAC,wBAAA,CAAA;QAE/BJ,OAAAA,CAAQK,UAAU,GAAGL,OAAAA,CAAQK,UAAU,GAAGL,OAAAA,CAAQK,UAAU,GAAG,EAAC;AAChEL,QAAAA,OAAAA,CAAQK,UAAU,CAACC,uBAAAA,CAAa,GAAGC,qBAAUC,IAAI;AAEjD,QAAA,MAAMC,aAAAA,GAAgBT,OAAAA,CAAQU,UAAU,GACpCP,SAAAA,CAAMQ,OAAO,CAACC,WAAAA,CAAQC,MAAM,EAAA,EAAIb,OAAAA,CAAQU,UAAU,CAAA,GAClDT,GAAAA;AAEJ,QAAA,OAAO,IAAIa,uCAAAA,CACTZ,MAAAA,CAAOJ,SAAS,CAACC,MAAMC,OAAAA,EAASS,aAAAA,CAAAA,CAAAA;AAEpC,IAAA;AAIOM,IAAAA,OAAAA,CAAQH,OAAgB,EAA4B;QACzD,MAAMI,IAAAA,GAAOb,SAAAA,CAAMY,OAAO,CAACH,OAAAA,CAAAA;AAE3B,QAAA,IAAII,IAAAA,EAAM;AACR,YAAA,OAAO,IAAIF,uCAAAA,CAAoBE,IAAAA,CAAAA;AACjC,QAAA;QAEA,OAAOC,SAAAA;AACT,IAAA;;AAVON,QAAAA,IAAAA,CAAAA,OAAAA,GAAmCR,UAAMQ,OAAO;;AAWzD;;;;"}